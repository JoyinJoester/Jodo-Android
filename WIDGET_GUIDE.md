# Jodo 桌面小组件功能

## 概述
Jodo Android应用现在支持桌面小组件功能，让你可以在桌面上直接查看和管理任务，无需打开应用。

## 功能特性

### 🎯 核心功能
- **任务列表显示**: 在桌面显示最多10个未完成任务
- **快速添加**: 直接从小组件添加新任务
- **任务完成**: 点击复选框快速标记任务完成
- **应用跳转**: 点击任务或"查看全部"按钮跳转到主应用
- **实时刷新**: 支持手动刷新和自动更新

### 🎨 界面设计
- **现代化UI**: 模仿微软Todo的设计风格
- **深色主题**: 与应用保持一致的深色主题
- **紧凑布局**: 优化的小组件尺寸，节省桌面空间
- **清晰显示**: 任务标题、截止日期、星标状态一目了然

## 安装使用

### 添加小组件到桌面
1. **长按桌面空白处**
2. **选择"小组件"或"Widgets"**
3. **找到"Jodo"应用分类**
4. **选择"任务列表"小组件**
5. **拖拽到桌面合适位置**

### 小组件操作
- **添加任务**: 点击"添加任务"按钮
- **完成任务**: 点击任务前的复选框
- **编辑任务**: 点击任务内容
- **刷新列表**: 点击右上角刷新按钮
- **查看全部**: 点击"查看全部"打开主应用

## 技术实现

### 文件结构
```
app/src/main/
├── java/takagicom/todo/jodo/widget/
│   ├── TaskWidgetProvider.kt          # 小组件核心逻辑
│   └── TaskWidgetRemoteViewsService.kt # 列表数据服务
├── res/layout/
│   ├── widget_task_list.xml           # 小组件主布局
│   ├── widget_task_item.xml           # 任务项布局
│   └── widget_empty_view.xml          # 空状态布局
├── res/drawable/
│   ├── widget_background.xml          # 小组件背景
│   ├── widget_item_background.xml     # 任务项背景
│   └── widget_button_background.xml   # 按钮背景
└── res/xml/
    └── task_widget_info.xml           # 小组件配置
```

### 关键组件

#### TaskWidgetProvider
- 处理小组件生命周期
- 管理用户交互事件
- 更新小组件内容

#### TaskWidgetRemoteViewsService
- 为ListView提供数据
- 动态生成任务项视图
- 处理任务状态显示

### 数据流程
```
TaskRepository → TaskWidgetRemoteViewsService → RemoteViews → 桌面显示
```

## 自定义配置

### 小组件尺寸
- **最小尺寸**: 250dp × 110dp
- **推荐尺寸**: 4×2 网格单元
- **支持调整**: 水平和垂直方向可调整

### 更新频率
- **自动更新**: 每30分钟
- **手动刷新**: 随时可用
- **数据变化**: 实时同步

### 显示规则
- 只显示未完成任务
- 按创建时间排序
- 最多显示10个任务
- 自动隐藏已删除任务

## 注意事项

### 性能优化
- 使用RemoteViews减少内存占用
- 限制显示任务数量避免过度加载
- 后台线程处理数据更新

### 兼容性
- Android 5.0 (API 21) 及以上版本
- 支持不同屏幕密度
- 适配各种桌面启动器

### 权限要求
- 无需额外权限
- 使用应用已有数据权限
- 安全的数据访问

## 故障排除

### 小组件不显示
1. 检查应用是否正常安装
2. 重启设备或桌面启动器
3. 重新添加小组件

### 数据不更新
1. 点击刷新按钮
2. 检查应用数据同步
3. 重新添加小组件

### 点击无响应
1. 确保应用未被系统限制
2. 检查应用权限设置
3. 重启应用

## 开发说明

### 扩展功能
可以在现有基础上添加：
- 任务分类过滤
- 优先级显示
- 自定义主题
- 多种尺寸支持

### 代码维护
- 遵循现有代码规范
- 保持与主应用数据同步
- 定期测试兼容性

---

**版本**: 1.0  
**更新时间**: 2025年6月7日  
**开发者**: Jodo Team
